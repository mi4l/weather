# IsoWeather Town

IsoWeather Town is a browser-based PWA where you build an isometric low-poly town and run weather simulations (rain, lightning/thunder, and tornadoes with siren logic) entirely client-side.

## Stack

- Vite + TypeScript
- Three.js (orthographic isometric rendering)
- vite-plugin-pwa (manifest + service worker caching)
- Web Audio API (synthesized rain, thunder, and siren)

## Features (v1)

- 32x32 procedural low-poly terrain grid
- Build mode:
  - Place houses (procedural dimensions + roof variation)
  - Place roads (neighbor-connected geometry)
  - Erase roads/houses
- Simulation mode:
  - Rain particle field with dynamic rain ambience
  - Lightning flashes with delayed thunder
  - Tornado spawning/movement with building shake
  - Siren fades in when tornado approaches town, fades out after clear
- Local persistence of town layout (`localStorage`)
- Installable PWA with offline support after first load

## Scripts

- `npm run dev` - run local dev server
- `npm run build` - typecheck + production build to `dist/`
- `npm run preview` - preview built app locally
- `npm run deploy` - optional manual deployment to `gh-pages` branch using `gh-pages`

## Local Development

1. Install dependencies:

```bash
npm install
```

2. Start dev server:

```bash
npm run dev
```

3. Open the printed localhost URL.

## GitHub Pages Deployment

This repo includes a Pages workflow at:

- `.github/workflows/deploy.yml`

### One-time GitHub setup

1. Push repository to GitHub.
2. In repository settings:
   - Go to **Pages**
   - Set **Build and deployment** source to **GitHub Actions**.

### Deploy

- Push to `main`.
- The workflow builds with `BASE_URL=/<repo-name>/` so Vite assets, manifest, and service worker scope work correctly on GitHub Pages.

## PWA Notes

- Manifest and service worker are generated by `vite-plugin-pwa`.
- Precache includes app shell and static assets.
- Runtime cache includes audio requests.
- Offline support is available after first successful load.

## Controls

- Drag to pan
- Mouse wheel / pinch to zoom
- Tap/click to place in Build mode
- Weather controls and audio controls in the top-left overlay

